/*
 * Sinclair Project
 * author Lazaro Gamio
 * copyright The McClatchy Company
 */

define("templates",[],function(){return this.JST=this.JST||{},this.JST["default/folio.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div id="floating-folio" class="folio">\n  ',tracker&&(__p+='\n    <div class="perc-holder">\n      <div id="tracker"></div>\n    </div> \n  '),__p+='\n  <a href="http://www.miamiherald.com" target="_blank" class="logoB logo"></a>\n  <div id="folio-info">\n    <h2 class="small ral fat upper folio-header"><pre class="folio-title" id="folio-title">'+((__t=folioTitle)==null?"":__t)+'</pre></h2>\n    <nav class="social-tools">\n      <a class="share-icon twitter-share" href="http://twitter.com/home?status='+((__t=pageTitle)==null?"":__t)+"+"+((__t=shortUrl)==null?"":__t)+'" onclick="window.open(return false; this.href, \'_blank,toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=260\')"></a>\n      <a class="share-icon facebook-share" href="http://www.facebook.com/share.php?u='+((__t=shortUrl)==null?"":__t)+"&title="+((__t=pageTitle)==null?"":__t)+'" onclick="window.open(return false; this.href,\'_blank\',\'toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=260\')"></a>\n      <a class="share-icon google-share" href="https://plus.google.com/share?url='+((__t=shortUrl)==null?"":__t)+'" onclick="window.open(return false; this.href,\'_blank\',\'toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=260\')"></a>\n    </nav>\n  </div>\n  <div class="clearfix"></div>\n</div>\n';return __p},this.JST["default/footer.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="footer-list ral upper fat xsmall">\n  <a href="http://miamiherald.com" target="_blank" class="logo logoB-tiny"></a>\n  ',_.each(links,function(e){__p+='\n    <a href="'+((__t=e.url)==null?"":__t)+'" target="_blank">'+((__t=e.name)==null?"":__t)+"</a>\n  "}),__p+="\n</div>\n";return __p},this.JST["default/photo.jst"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<figure class="'+((__t=blockType)==null?"":__t)+' block-item photo-item">\n  <img src="'+((__t=url)==null?"":__t)+'" alt="'+((__t=cutline)==null?"":__t)+'"/>\n  <small class="photo-credit xsmall upper ral align-right block">'+((__t=credit)==null?"":__t)+"</small>\n  <figcaption>"+((__t=cutline)==null?"":__t)+'</figcaption>\n  <div class="clearfix"></div>\n</figure>\n';return __p},this.JST["default/quote.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<blockquote class="'+((__t=blockType)==null?"":__t)+' block-item quote-item" cite="'+((__t=citeSrc)==null?"":__t)+'">\n  <p class="large heavier bright">&ldquo;'+((__t=quote)==null?"":__t)+'&rdquo;</p>\n  <small class="block">\n    ',attrib,__p+="\n    ",citeSrc&&(__p+='\n      <a class="gray-link" href="'+((__t=citeSrc)==null?"":__t)+'" target="_blank">Source &rarr;</a>\n    '),__p+="\n  </small>\n</blockquote>\n";return __p},this.JST["default/refer.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<aside class="'+((__t=blockType)==null?"":__t)+' block-item comment-item">\n  <h3 class="ral fat upper red">'+((__t=hed)==null?"":__t)+"</h3>\n  <p>"+((__t=readout)==null?"":__t)+"\n    ",url&&(__p+='\n     <a href="'+((__t=url)==null?"":__t)+'">'+((__t=gotext)==null?"":__t)+"</a> \n    "),__p+="\n  </p>\n</aside>\n";return __p},this.JST["default/video.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){__p+='<figure class="'+((__t=blockType)==null?"":__t)+' block-item video-item">\n  ';var videoSource;if(videoID.match(/^http(s)*:\/\//)){var rand=Math.floor(Math.random()*1e4);videoSource=videoID,videoID="video-"+rand}else videoSource="http://www.youtube.com/embed/"+videoID+"?modestbranding&showinfo=0";__p+='\n  <iframe class="yt-embed" id="'+((__t=videoID)==null?"":__t)+'" src="'+((__t=videoSource)==null?"":__t)+'" frameborder="0" allowfullscreen></iframe>\n  <figcaption><span class="vid-spr ral fat upper">'+((__t=videoTitle)==null?"":__t)+"</span>"+((__t=videoCaption)==null?"":__t)+"</figcaption>\n</figure>\n"}return __p},this.JST["miami/folio.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)tracker&&(__p+='\n  <div class="perc-holder">\n    <div id="tracker"></div>\n  </div> \n'),__p+='\n<div id="floating-folio">\n  <a href="http://www.miamiherald.com" target="_blank" class="logoB"></a>\n  <div id="folio-info">\n    <h2 class="small ral fat upper folio-title" style="position: relative; top: 10px; display: inline-block"><pre id="folio-title">'+((__t=folioTitle)==null?"":__t)+'</pre></h2>\n    <nav class="social-tools">\n      <a class="share-icon twitter-share" href="http://twitter.com/home?status='+((__t=pageTitle)==null?"":__t)+"+"+((__t=shortUrl)==null?"":__t)+'" onclick="window.open(return false; this.href, \'_blank,toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=260\')"></a>\n      <a class="share-icon facebook-share" href="http://www.facebook.com/share.php?u='+((__t=shortUrl)==null?"":__t)+"&title="+((__t=pageTitle)==null?"":__t)+'" onclick="window.open(return false; this.href,\'_blank\',\'toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=260\')"></a>\n      <a class="share-icon google-share" href="https://plus.google.com/share?url='+((__t=shortUrl)==null?"":__t)+'" onclick="window.open(return false; this.href,\'_blank\',\'toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=260\')"></a>\n    </nav>\n  </div>\n  <div class="clearfix"></div>\n</div>\n\n';return __p},this.JST["miami/footer.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="footer-list ral upper fat xsmall">\n  <a href="http://miamiherald.com" target="_blank" class="logoB-tiny"></a>\n  ',_.each(links,function(e){__p+='\n    <a href="'+((__t=e.url)==null?"":__t)+'" target="_blank">'+((__t=e.name)==null?"":__t)+"</a>\n  "}),__p+="\n</div>\n";return __p},this.JST["miami/photo.jst"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<figure class="'+((__t=blockType)==null?"":__t)+' block-item photo-item">\n  <img src="'+((__t=url)==null?"":__t)+'" alt="'+((__t=cutline)==null?"":__t)+'"/>\n  <small class="photo-credit xsmall upper ral align-right block">'+((__t=credit)==null?"":__t)+"</small>\n  <figcaption>"+((__t=cutline)==null?"":__t)+'</figcaption>\n  <div class="clearfix"></div>\n</figure>\n';return __p},this.JST["miami/quote.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<blockquote class="'+((__t=blockType)==null?"":__t)+' block-item quote-item" cite="'+((__t=citeSrc)==null?"":__t)+'">\n  <p class="large heavier bright">&ldquo;'+((__t=quote)==null?"":__t)+'&rdquo;</p>\n  <small class="block">\n    ',attrib,__p+="\n    ",citeSrc&&(__p+='\n      <a class="gray-link" href="'+((__t=citeSrc)==null?"":__t)+'" target="_blank">Source &rarr;</a>\n    '),__p+="\n  </small>\n</blockquote>\n";return __p},this.JST["miami/refer.jst"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){var mainClass=blockType==="wide"?"right":"wide";__p+='\n<aside class="'+((__t=mainClass)==null?"":__t)+' block-item comment-item">\n  <h3 class="ral fat upper red">'+((__t=hed)==null?"":__t)+"</h3>\n  <p>"+((__t=readout)==null?"":__t)+"\n    ",url&&(__p+='\n     <a href="'+((__t=url)==null?"":__t)+'">'+((__t=gotext)==null?"":__t)+"</a> \n    "),__p+="\n  </p>\n</aside>\n"}return __p},this.JST["miami/video.jst"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<figure class="'+((__t=blockType)==null?"":__t)+' block-item video-item">\n  <iframe class="yt-embed" id="'+((__t=videoID)==null?"":__t)+'" src="http://www.youtube.com/embed/'+((__t=videoID)==null?"":__t)+'?modestbranding&showinfo=0" frameborder="0" allowfullscreen></iframe>\n  <figcaption><span class="vid-spr ral fat upper">'+((__t=videoTitle)==null?"":__t)+"</span>"+((__t=videoCaption)==null?"":__t)+"</figcaption>\n</figure>\n";return __p},this.JST});var Sinclair=function(e,t){var n={loadContent:{container:"",def:new $.Deferred},folio:{pageTitle:"The Sinclair Project demo page",folioTitle:"Sinclair Demo",shortUrl:"https://github.com/mcclatchy/sinclair",flat:!0,tracker:!0,template:undefined},simpleFooter:{links:[],template:undefined},photo:{blockType:"wide",url:"",credit:"",cutline:"",template:undefined},quote:{blockType:"wide",quote:"",attrib:"",citeSrc:undefined,template:undefined},refer:{blockType:"wide",hed:"",readout:"",url:"",gotext:""},video:{blockType:"wide",videoID:"",videoTitle:"",videoCaption:"",ratio:1}};return{init:function(e){$.extend(!0,n,e),this.defaults=n,$.extend($.fn,this.fn)},loadContent:function(e){return e=$.extend(n.loadContent,e),!e.scrapeResource&&!e.fallback&&e.def.reject("You did not include a resource"),$.ajax({url:e.scrapeResource}).done(function(t){t=t.replace(/<(img|script)\b[^>]*>/ig,"");var n=$("<div>").append($.parseHTML(t)).find(e.container).html();e.def.resolve(n)}).fail(function(){e.fallback?$.ajax({url:e.fallback}).done(function(t){t=t.replace(/<(img|script)\b[^>]*>/ig,"");var n=$("<div>").append($.parseHTML(t)).find(e.container).html();e.def.resolve(n)}).fail(function(){e.def.reject("Could not get any of the resources")}):e.def.reject("Scrape Resource not available and no fallback set")}),e.def},fn:{folio:function(e){var t=this;e=$.extend(n.folio,e),typeof e.flat=="string"&&(e.flat=e.flat==="true"?!0:!1),typeof e.tracker=="string"&&(e.tracker=e.tracker==="true"?!0:!1),e.template||(e.template=n.templates["default/folio.jst"]);var r=e.template(e);return $("body").prepend(r),e.flat===!0&&($("#floating-folio").show(),$("body").css("margin-top",$("#floating-folio").outerHeight(!0)+"px")),$(window).scroll(function(){var n=t.outerHeight(!0),r=$(window).scrollTop(),i=$(window).width();r>n&&i>920&&e.flat!==!0&&$("#floating-folio").slideDown(200),r<n&&i>920&&e.flat!==!0&&$("#floating-folio").slideUp(200),$totalHeight=$("body").height()-$(window).height(),$("#tracker").css("width",r/$totalHeight*100+"%")}),t},simpleFooter:function(e){var t=this;e=$.extend(n.simpleFooter,e),e.template||(e.template=n.templates["default/footer.jst"]);var r=e.template(e);return t.append(r),t},photo:function(e){var t=this;e=$.extend(n.photo,e),e.template||(e.template=n.templates["default/photo.jst"]);var r=e.template(e);return t.before(r),t},quote:function(e){var t=this;e=$.extend(n.quote,e),e.template||(e.template=n.templates["default/quote.jst"]);var r=e.template(e);return t.before(r),t},refer:function(e){var t=this;e=$.extend(n.refer,e),e.template||(e.template=n.templates["default/refer.jst"]);var r=e.template(e);return t.before(r),t},video:function(e){var t=this;e=$.extend(n.video,e),e.template||(e.template=n.templates["default/video.jst"]);var r=e.template(e);return t.before(r),$("#"+e.videoID).height(function(){return $(this).width()/e.ratio}),t}}}};typeof define=="function"&&define.amd?(require.config({paths:{jquery:"http://code.jquery.com/jquery.min",underscore:"http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min"},shim:{templates:["underscore"]}}),define("sinclair",["underscore","jquery","templates"],function(e,t,n){var r=new Sinclair;return r.init({templates:n}),r})):window.$&&window._&&window.Templates?(window.sinclair=new Sinclair,window.sinclair.init({templates:window.Templates}),function(e){e.extend(e.fn,window.sinclair.fn)}(jQuery)):console.error("Error: Sinclair project requires jQuery, UnderscoreJS and the Templates be loaded when not using RequireJS.");